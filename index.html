<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DUO Up - Cyberpunk Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
  body {
    margin: 0;
    font-family: 'Orbitron', sans-serif;
    background: linear-gradient(270deg,#0D0D0D,#1A1A1A,#0D0D0D);
    background-size:600% 600%;
    animation: gradientAnimation 15s ease infinite;
    color:white;
    display:flex;
    height:100vh;
    overflow:hidden;
  }
  @keyframes gradientAnimation {
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }

  /* Sidebar */
  .sidebar{
    width:80px;
    background-color:#0D0D0D;
    border-right:2px solid #00FFFF;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px 0;
  }
  .sidebar h1{
    writing-mode: vertical-rl;
    transform: rotate(180deg);
    font-family: 'Orbitron', sans-serif;
    color: #00FFFF;
    text-shadow:0 0 5px #00FFFF,0 0 10px #00FFFF,0 0 20px #00FFFF;
    margin-bottom:40px;
  }

  /* Main Content */
  .main{
    flex:1;
    padding:20px;
    display:flex;
    flex-direction:column;
    overflow-y:auto;
    gap:20px;
  }

  .user-info{
    display:flex;
    align-items:center;
    gap:15px;
    margin-bottom:20px;
  }
  .user-info img{
    width:60px; height:60px; border-radius:50%; border:2px solid #00FFFF;
  }
  .online-dot{
    position:relative;
    width:12px; height:12px;
    border-radius:50%;
    border:2px solid #0D0D0D;
    box-shadow:0 0 5px #39FF14,0 0 10px #39FF14;
  }
  .username{
    font-size:1.8em;
    color:#00FFFF;
    text-shadow:0 0 5px #00FFFF,0 0 10px #00FFFF,0 0 20px #00FFFF;
  }

  /* Sections */
  h2{
    font-family: 'Audiowide', sans-serif;
    color:#FF00FF;
    text-shadow:0 0 5px #FF00FF,0 0 10px #FF00FF,0 0 20px #FF00FF;
  }
  .card-container{
    display:flex;
    flex-wrap:wrap;
    gap:15px;
  }
  .card{
    background:#1A1A1A;
    border:2px solid #00FFFF;
    border-radius:16px;
    padding:15px;
    width:280px;
    box-shadow:0 0 5px #00FFFF,0 0 10px #00FFFF,0 0 20px #00FFFF;
    transition:0.3s;
  }
  .card:hover{ border-color:#FF00FF; box-shadow:0 0 10px #FF00FF,0 0 20px #FF00FF,0 0 30px #FF00FF; }
  .card h3{ font-family: 'Audiowide', sans-serif; font-size:1.2em; margin-bottom:10px; color:#00FFFF; }
  .card p{ font-size:1em; margin-bottom:10px; }

  .neon-btn{
    padding:7px 15px;
    font-family:'Orbitron',sans-serif;
    font-weight:bold;
    color:white;
    background:transparent;
    border:2px solid #00FFFF;
    border-radius:6px;
    cursor:pointer;
    box-shadow:0 0 5px #00FFFF,0 0 10px #00FFFF,0 0 20px #00FFFF;
    transition:0.3s;
    margin-right:5px;
  }
  .neon-btn:hover{ border-color:#FF00FF; box-shadow:0 0 10px #FF00FF,0 0 20px #FF00FF,0 0 30px #FF00FF; }

  /* Chat */
  .chat-panel{
    background:#0D0D0D;
    border:2px solid #FF00FF;
    border-radius:16px;
    padding:15px;
    width:400px;
    max-height:400px;
    display:flex;
    flex-direction:column;
    gap:10px;
    overflow-y:auto;
  }
  .message{
    display:flex;
    align-items:flex-end;
    gap:10px;
  }
  .message.outgoing{ flex-direction:row-reverse; }
  .message-bubble{
    padding:10px 15px;
    border-radius:12px;
    max-width:70%;
    font-family:'Orbitron',sans-serif;
    word-wrap: break-word;
  }
  .neon-incoming{
    background:#1A1A1A;
    border:2px solid #00FFFF;
    box-shadow:0 0 5px #00FFFF,0 0 10px #00FFFF,0 0 20px #00FFFF;
  }
  .neon-outgoing{
    background:#1A1A1A;
    border:2px solid #FF00FF;
    box-shadow:0 0 5px #FF00FF,0 0 10px #FF00FF,0 0 20px #FF00FF;
  }
  .avatar-small{ width:30px; height:30px; border-radius:50%; border:2px solid #00FFFF; }

  .chat-input{
    display:flex;
    gap:10px;
  }
  .chat-input input{
    flex:1;
    padding:8px;
    border-radius:8px;
    border:2px solid #00FFFF;
    background:transparent;
    color:white;
  }
</style>
</head>
<body>

  <div class="sidebar"><h1>DUO UP</h1></div>

  <div class="main">
    <!-- User Info -->
    <div class="user-info">
      <img id="userAvatar" src="https://i.pravatar.cc/60">
      <span class="online-dot" id="onlineDot"></span>
      <div class="username" id="username">Welcome, Gamer</div>
    </div>

    <!-- Friend Requests -->
    <h2>Friend Requests</h2>
    <div class="card-container" id="friendRequests"></div>

    <!-- Suggested Duos -->
    <h2>Suggested Duos</h2>
    <div class="card-container" id="suggestedDuos"></div>

    <!-- Active Friends -->
    <h2>Active Duos</h2>
    <div class="card-container" id="activeDuos"></div>

    <!-- Chat Panel -->
    <h2>Chat</h2>
    <div class="chat-panel" id="chatPanel"></div>
    <div class="chat-input">
      <input type="text" id="messageInput" placeholder="Type a message...">
      <button class="neon-btn" onclick="sendMessage()">Send</button>
    </div>
  </div>

<script>
  // Firebase
  const firebaseConfig = {
    apiKey:"AIzaSyDVHxatohLvJNqIHXjf1ZXdmmWX5W1EpNw",
    authDomain:"duoup-cfae6.firebaseapp.com",
    projectId:"duoup-cfae6",
    storageBucket:"duoup-cfae6.firebasestorage.app",
    messagingSenderId:"812263060524",
    appId:"1:812263060524:web:ac09c3ae610db1cd110d89",
    measurementId:"G-46B67F90FK"
  };
  firebase.initializeApp(firebaseConfig);
  const auth=firebase.auth();
  const db=firebase.firestore();

  // Mock login
  auth.signInAnonymously().then(user=>{
    const uid=user.user.uid;

    // Fetch current user info
    db.collection("users").doc(uid).get().then(doc=>{
      if(doc.exists){
        const data=doc.data();
        document.getElementById("username").innerText=data.username;
        document.getElementById("userAvatar").src=data.profileImageUrl;
        document.getElementById("onlineDot").style.backgroundColor=data.status==='online'?'#39FF14':'#FF0000';
      }
    });

    // Friend Requests
    db.collection("friendRequests").where("receiverId","==",uid).where("status","==","pending").onSnapshot(snapshot=>{
      const container=document.getElementById("friendRequests");
      container.innerHTML="";
      snapshot.docs.forEach(doc=>{
        const req=doc.data();
        db.collection("users").doc(req.senderId).get().then(senderDoc=>{
          const sender=senderDoc.data();
          const card=document.createElement("div");
          card.className="card";
          card.innerHTML=`
            <div class="avatar-container"><img src="${sender.profileImageUrl}" class="avatar-small"></div>
            <h3>${sender.username}</h3>
            <p>wants to duo in ${req.gameSlug}</p>
            <button class="neon-btn" onclick="acceptRequest('${doc.id}','${req.senderId}','${req.gameSlug}')">Accept</button>
            <button class="neon-btn" onclick="rejectRequest('${doc.id}')">Reject</button>
          `;
          container.appendChild(card);
        });
      });
    });

    // Suggested Duos (example: users sharing a game)
    db.collection("users").where("status","==","online").limit(5).get().then(snapshot=>{
      const container=document.getElementById("suggestedDuos");
      snapshot.docs.forEach(doc=>{
        if(doc.id!==uid){
          const u=doc.data();
          const card=document.createElement("div");
          card.className="card";
          card.innerHTML=`
            <div class="avatar-container"><img src="${u.profileImageUrl}" class="avatar-small"></div>
            <h3>${u.username}</h3>
            <p>Suggested Duo</p>
            <button class="neon-btn" onclick="sendFriendRequest('${doc.id}')">Send Request</button>
          `;
          container.appendChild(card);
        }
      });
    });

    // Active Duos
    db.collection("users").where("status","==","online").limit(5).get().then(snapshot=>{
      const container=document.getElementById("activeDuos");
      snapshot.docs.forEach(doc=>{
        if(doc.id!==uid){
          const u=doc.data();
          const card=document.createElement("div");
          card.className="card";
          card.innerHTML=`
            <div class="avatar-container"><img src="${u.profileImageUrl}" class="avatar-small"></div>
            <h3>${u.username}</h3>
            <p>Online Now</p>
            <button class="neon-btn" onclick="openChat('${doc.id}')">Chat Now</button>
          `;
          container.appendChild(card);
        }
      });
    });

    // Chat real-time listener
    window.currentChatId=null;
    window.currentChatUid=null;
  });

  // Accept / Reject
  function acceptRequest(requestId,senderId,gameSlug){
    db.collection("friendRequests").doc(requestId).update({status:"accepted"}).then(()=>{
      db.collection("friends").add({
        user1Id:auth.currentUser.uid,
        user2Id:senderId,
        sharedGames:[gameSlug],
        timestamp:firebase.firestore.FieldValue.serverTimestamp()
      });
    });
  }
  function rejectRequest(requestId){
    db.collection("friendRequests").doc(requestId).update({status:"rejected"});
  }

  function sendFriendRequest(receiverId){
    db.collection("friendRequests").add({
      senderId:auth.currentUser.uid,
      receiverId:receiverId,
      gameSlug:"valorant",
      status:"pending",
      timestamp:firebase.firestore.FieldValue.serverTimestamp()
    });
  }

  function openChat(otherUid){
    window.currentChatUid=otherUid;
    const chatPanel=document.getElementById("chatPanel");
    chatPanel.innerHTML="";
    const chatId=[auth.currentUser.uid,otherUid].sort().join("_");

    db.collection("messages").where("conversationId","==",chatId).orderBy("timestamp")
    .onSnapshot(snapshot=>{
      chatPanel.innerHTML="";
      snapshot.docs.forEach(doc=>{
        const msg=doc.data();
        const bubble=document.createElement("div");
        bubble.className="message";
        bubble.innerHTML=`
          <div class="avatar-small" style="background-image:url('')"></div>
          <div class="message-bubble ${msg.senderId===auth.currentUser.uid?'neon-outgoing':'neon-incoming'}">${msg.content}</div>
        `;
        if(msg.senderId===auth.currentUser.uid) bubble.classList.add("outgoing");
        chatPanel.appendChild(bubble);
      });
      chatPanel.scrollTop=chatPanel.scrollHeight;
    });

    window.currentChatId=chatId;
  }

  function sendMessage(){
    if(!window.currentChatId) return alert("Open a chat first!");
    const input=document.getElementById("messageInput");
    const content=input.value;
    if(!content) return;
    db.collection("messages").add({
      conversationId:window.currentChatId,
      content:content,
      senderId:auth.currentUser.uid,
      timestamp:firebase.firestore.FieldValue.serverTimestamp(),
      isRead:"false",
      type:"text"
    });
    input.value="";
  }

</script>
</body>
</html>
